{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e26063b7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting PyPDF2\n",
      "  Downloading pypdf2-3.0.1-py3-none-any.whl (232 kB)\n",
      "     ---------------------------------------- 0.0/232.6 kB ? eta -:--:--\n",
      "     - -------------------------------------- 10.2/232.6 kB ? eta -:--:--\n",
      "     ---- -------------------------------- 30.7/232.6 kB 325.1 kB/s eta 0:00:01\n",
      "     ------ ------------------------------ 41.0/232.6 kB 326.8 kB/s eta 0:00:01\n",
      "     ----------------- ------------------ 112.6/232.6 kB 656.4 kB/s eta 0:00:01\n",
      "     ------------------------------------ - 225.3/232.6 kB 1.1 MB/s eta 0:00:01\n",
      "     -------------------------------------- 232.6/232.6 kB 1.0 MB/s eta 0:00:00\n",
      "Installing collected packages: PyPDF2\n",
      "Successfully installed PyPDF2-3.0.1\n"
     ]
    }
   ],
   "source": [
    "!pip install PyPDF2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "1b82c21b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "168\n",
      "興達電廠燃氣 機組更新改建計畫環境影響說明書                                           第七章 \n",
      "台灣電力公司                               \n",
      "7-1 第七章  預測開發行為可能引起之環境影響  \n",
      "7.1  物理及化學環境  \n",
      "7.1.1 地形及地質  \n",
      "依據本計畫調查 結果，興達電廠燃氣機組預定地皆 為平坦濕地，開發行為\n",
      "應不致對地形造成影響。  \n",
      "參閱中央地質調查所公布之台南以及高雄初級土壤液化潛勢圖，本案工址\n",
      "所在之高雄市永安區屬高雄市土 壤液化潛勢分析第二期計畫，尚未有公開之液\n",
      "化資訊。故依「興達燃氣機組更新改建計畫可研地質鑽探報告書 (106年1月)」，\n",
      "彙整出液化潛能分析結果，地表最大水平加速度為 0.076g 時，燃氣機組預定地\n",
      "屬輕微液化程度，天然氣管線預定路線之液化危險 度極低；但當地表最大水平\n",
      "加速度達 0.320g 以上，燃氣機組預定地及天然氣管線預定路線皆屬嚴重液化程\n",
      "度，分析資料詳見 附錄 26.6(附件 2)。 \n",
      "本廠址地層地表下至 20米範圍內屬灰色粉土質黏土夾砂質粉土 (N=1~7)，\n",
      "部分地層可能有液化之顧慮且具沉陷機制，此地層於超額載重作用下，其基礎\n",
      "沉陷量大。目前 細部設計階段正辦理細部地質鑽探與土壤試驗作業，未來將依\n",
      "試驗成果考量載重，並依相關設計規範進行地質改良與基礎設計。   \n",
      "考量上述分析結果，一般可於工程設計採行之因應對策內容摘述如下：  \n",
      "1.土壤改良：化學固結工法 (深層攪拌工法、特殊石灰樁 )，以及排水工法 (真\n",
      "空壓密工法、礫石樁、排水帶 )。 \n",
      "2.基礎型式選擇或處理：樁基礎、基礎版下砂礫層、地下圍牆基礎。  \n",
      "3.管線型式選擇：可撓管、耐震伸縮材料。  \n",
      "7.1.2 斷層及地震  \n",
      "一、地震  \n",
      "本計畫周圍之地震活動，主要 分布於北方臺南市區域及西方外海一\n",
      "帶，距離超過 15公里。自 1973~2017 年5月間，計畫區域半徑 50公里範\n",
      "圍內共發生 41,460次地震，單位面積發生地震次數比約為 12次/年/100平\n",
      "方公里，遠低於全臺平均 (74次/年/100平方公里 )。在這 41,460次地震事\n",
      "件中，多屬於規模小於 3之微震 (39,084次)；規模介於 3至5之間的地震\n",
      "有2,346次，而規模 5以上可能造成危害之地震僅有 30次發生紀錄，平均\n"
     ]
    }
   ],
   "source": [
    "import PyPDF2\n",
    " \n",
    "# creating a pdf file object\n",
    "pdfFileObj = open(\"D:\\E\\My Documents\\EIAs\\電廠\\GAS_EIA\\(1070401A) 興達電廠燃氣機組更新改建計畫環境影響說明書\\C07.pdf\", 'rb')\n",
    " \n",
    "# creating a pdf reader object\n",
    "pdfReader = PyPDF2.PdfReader(pdfFileObj)\n",
    " \n",
    "# printing number of pages in pdf file\n",
    "print(len(pdfReader.pages))\n",
    " \n",
    "# creating a page object\n",
    "pageObj = pdfReader.pages[0]\n",
    " \n",
    "# extracting text from page\n",
    "print(pageObj.extract_text())\n",
    " \n",
    "# closing the pdf file object\n",
    "#pdfFileObj.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "506efd5d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'str'>\n",
      "130985\n",
      "True\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "4956"
      ]
     },
     "execution_count": 93,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a=''\n",
    "i=1\n",
    "for pageObj in pdfReader.pages:\n",
    "    a+=pageObj.extract_text().replace('7-'+str(i)+' ','')\n",
    "    i+=1\n",
    "print(type(a))\n",
    "print(len(a))\n",
    "print('\\n' in a)\n",
    "lines=a.split('\\n')\n",
    "len(lines)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "530f202d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['7.1.1 地形及地質  ', '3.管線型式選擇', '7.1.2 斷層及地震  ', '7.1.4 空氣品質  ', '1.評估條件  ', '2.影響分析  ', '(1)氣狀污染物 (SO 2、NO 2、CO) ', '(2)粒狀污染物 (TSP、PM 10、PM 2.5). ', '1.本計畫燃氣機組排放量  ', '(1)興達電廠全廠空污排放量計算  ', '2.原生性空氣污染物影響分析  ', '(1)氣狀污染物 (SO 2、NO 2) ', '(1)模式設定及輸入資料  ', '(1)基準模擬結果與模式性能評估  ', '(2)臭氧評估結果  ', '(3)PM 10及PM 2.5評估結果  ', '(4)新舊燃氣機組空品抵換 評估  ', '24小時值  ', '24小時值  ', '24小時值  ', '24小時值  ', '1.評估條件  ', '2.影響分析  ', '(1)氣狀污染物 (SO 2、NO 2、CO) ', '1.施工機具  ', '2.化糞池 (水肥 ) ', '4,765,440,000 m3/年。  ', '0.53萬噸 CO 2e/年 ', '1.噪音主要影響區位  ', '2.噪音影響評估基準  ', '3.評估模式說明  ', '4.施工期間噪音影響預測  ', '(1)工作面施工機具種類及數量  ', '(2)施工噪音  ', '1.電廠營運噪音  ', '(1)噪音主要影響區位  ', '(2)噪音影響評估基準  ', '(3)評估模式說明  ', '(4)噪音影響預測  ', '(5)道路交通噪音  ', '(1)噪音主要影響區位  ', '(2)噪音影響評估基準  ', '(3)評估模式說明  ', '(4)噪音影響預測  ', '(5)道路交通噪音  ', '1.施工期間振動  ', '(1)施工機具振動影響  ', '5公尺處  10公尺處  ', '(2)施工運輸車輛振動影響  ', '2.營運期間振動  ', '(1)電廠營運期間交通運輸振動  ', '1.施工區域地表 逕流廢水  ', '2.施工廢水及人員生活污水  ', '3.施工期間對承受水體之非點源污染模擬  ', '1.電廠綜合廢水  ', '2.員工生活污水  ', '7.1.7 海域水質  ', '7.1.8 廢棄物  ', '1.一般事業廢棄物  ', '2.公告應回收或再利用廢棄物  ', '3.混合五金廢料  ', '4.營建廢棄物  ', '102年溫升', '103年溫升', '104年溫升', '105年溫升', '106年溫升', '7.3.1 陸域植物  ', '7.3.2 陸域動物  ', '2.魚鷹', '3.紅隼', '3.計畫目標', '1000m  ', '1000m  ', '1000m  ', '1000m  ', '1000m  ', '1000m  ', '1000m  ', '1000m  ', '35.5公頃串聯南北綠', '41.25公頃', '7.3.4 海域生態  ', '7.3.5 電廠歷年監測數據分析  ', '1.汲入量及對當地漁業資源損失評估  ', '1.84×107 個/year。 ', '4.結論  ', '7.4.1  開發行為景觀現況美質影響調查與評估  ', '9km，屬於遠景距離，觀賞者中位。漯底山', '330m，屬於近景、觀賞者中位。施工及營運', '1.施工影響遊憩據點的交通可及性  ', '2.施工影響鄰近遊憩據點的遊憩體驗  ', '1.燃氣機組設置後的視覺影響  ', '1.興達港 /情人碼頭  ', '2.茄萣濕地公園  ', '3.永安濕地  ', '4.大崗山風景區  ', '5.鹽田彩繪村  ', '6.漯底山自然公園  ', '7.5.1 土地利用  ', '7.5.3 就業機會與產業結構  ', '7.5.4 公共設施 服務  ', '2.興達發電廠天然氣專管破漏緊急應變作業辦法。   ', '1.第一個條件是有漏氣現象；   ']\n"
     ]
    }
   ],
   "source": [
    "outlines=[l.split(':')[0].split('：')[0] for l in lines if (l[0].isdigit() or (l[0] in ['(','（'] and l[1].isdigit())) and (l[:2] != '7-') and len(l)<30 and FloatNotInLine(l)]\n",
    "outlines=[l for l in outlines if '-' not in l]\n",
    "outlines=[l for l in outlines if CharNotAhead(l)]\n",
    "print(outlines[:])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "id": "4c01e902",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7.1  物理及化學環境\n",
      "7.1.1 地形及地質\n",
      "1.土壤改良\n",
      "2.基礎型式選擇或處理\n",
      "3.管線型式選擇\n",
      "7.1.2 斷層及地震\n",
      "一、地震\n",
      "二、斷層\n",
      "7.1.3 土壤\n",
      "一、施工期間\n",
      "二、營運期間\n",
      "7.1.4 空氣品質\n",
      "一、空氣品質模擬\n",
      "(一)施工期間\n",
      "1.評估條件\n",
      "2.影響分析\n",
      "(1)氣狀污染物 (SO 2、NO 2、CO)\n",
      "(2)粒狀污染物 (TSP、PM 10、PM 2.5).\n",
      "(3)運輸道路路緣影響分析\n",
      "2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。\n",
      "2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。\n",
      "(二)營運期間\n",
      "1.本計畫燃氣機組排放量\n",
      "(1)興達電廠全廠空污排放量計算\n",
      "2.考量未來持續成長之電力需求，在符合排放標準及空污總量管制前提下，將既有廠區做整體性規劃，以充分最佳化利用空間。\n",
      "3.既有廠區於機組除役後的削減總量差額，將依總 量管制保留抵換辦法規定申請保留，視未來電力供應需求使用。\n",
      "4.依據台灣中油公司 之天然氣最大含硫量規範，硫氧化物濃度 推估為 0.8 ppm。\n",
      "5.107年後之燃煤機組空污排放量計算係以生煤許可量進行估算，並已考量空污改善效益。\n",
      "(C) 全廠排\n",
      "(A) 燃氣\n"
     ]
    }
   ],
   "source": [
    "outlines=[l.split(':')[0].split('：')[0].strip() for l in lines]\n",
    "outlines=[l for l in outlines if (dots(l) or CNnum(l) or ENnum(l))  and len(l)<60]# and FloatNotInLine(l)]\n",
    "outlines=[l for l in outlines if '-' not in l]\n",
    "#outlines=[l for l in outlines if CharNotAhead(l)]\n",
    "for i in outlines[:30]:\n",
    "    print(i)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "fe8683bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "def FloatNotInLine(line):\n",
    "    list=line.split()\n",
    "    for j in list:\n",
    "        try:\n",
    "            i=float(j)\n",
    "            return False\n",
    "        except:\n",
    "            continue\n",
    "    return True\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "36be198d",
   "metadata": {},
   "outputs": [],
   "source": [
    "def CharNotAhead(l):\n",
    "    if '月' in l[:3]:return False\n",
    "    if '%' in l[:4]:return False\n",
    "    if '％' in l[:4]:return False\n",
    "    return True"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "id": "3e711e74",
   "metadata": {},
   "outputs": [],
   "source": [
    "def dots(l):\n",
    "    tdic={'':'.','(':')','（':'）'}\n",
    "    for p in ['','(','(']:\n",
    "        for i in range(1,11):\n",
    "            a=p+str(i)+tdic[p]\n",
    "            n=len(a)\n",
    "            if l[:n]==a:return True\n",
    "    return False    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "059582ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "def CNnum(l):\n",
    "    num=['一','二','三','四','五','六','七','八','九','十',]\n",
    "    tdic={'':'、','(':')','（':'）'}\n",
    "    for p in ['','(','(']:\n",
    "        for i in num:\n",
    "            a=p+i+tdic[p]\n",
    "            n=len(a)\n",
    "            if l[:n]==a:return True\n",
    "    return False    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "id": "db2ccb19",
   "metadata": {},
   "outputs": [],
   "source": [
    "def ENnum(l):\n",
    "    num='ABCDEFGHabcdefgh'\n",
    "    tdic={'':'.','(':')','（':'）'}\n",
    "    for p in ['','(']:\n",
    "        for i in num:\n",
    "            t=''\n",
    "            if p in [' ','']:t='.'\n",
    "            a=p+i+tdic[p]\n",
    "            n=len(a)\n",
    "            if l[:n]==a:return True\n",
    "    return False   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "60a176c9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'興達電廠燃氣 機組更新改建計畫環境影響說明書                                           第七章 \\n台灣電力公司                               \\n7-73 及公告應回收 等類別，其一般事業廢棄物推估產量約 17.7萬公噸 /年、混\\n合五金廢料約 20公噸 /年及公告應回收之廢棄物產生量約 240公噸 /年。本\\n計畫營運期間產生之事業廢棄物將依「事業廢棄物貯存清除處理方法及設\\n施標準」之要求，規劃事業廢棄物貯存場妥善貯存後，遵循環保署頒布之\\n廢棄物清理法及其相關法規，委託合格之公民 營事業廢棄物清除處理機\\n構代為清除處理，並不致造成環境之影響。 本計畫未來如有涉及原物料\\n使用量及產品產量或營運擴增及其他改變，將依循廢棄物清理法施行細則\\n第12條規定辦理事業廢棄物清理計畫書變更或申請備查。  \\n另外，本計畫規劃設置一座海水淡化廠， 規劃優先採用膜法製程 ，\\n預估營運後將產 生約5公噸 /年之薄膜廢棄物 (實際廢棄物量將依進口海水\\n水質及海水淡化廠操作情形有所差異 )，汰換之薄膜將委由合格之公民營\\n事業廢棄物清除處理機構代為清除處理或交由廠商攜回處理，對環境不致\\n造成影響。  \\n \\n7.2  溫排水擴散模擬  \\n一、本計畫溫排水擴散模擬  \\n電廠循環冷卻水系統所排出之溫排水對於附近海域產生之主要影響\\n為溫升，必須符合行政院環境保護署公布之水污染防治法中「放流水標\\n準」水溫規定，即距排放口 500公尺處之表面水溫差不得超過 4°C。為達\\n法規要求，本計畫進行溫排水溫升擴散數值模擬，包括近域溫升數值模\\n擬(Near -Field Model) 及遠域溫升數值模擬 (Far-Field Model) 兩方面進行評\\n估，並以綜合溫升 (近、遠域模擬結果 加總 )來評估排放方案是否能達到法\\n規標準。興達電廠更新改建 燃氣計畫中， 溫排水量將維持既有電廠 溫排水\\n水量最大量 不超過 152 CMS，且導入現有之導流堤後排放海域，並無新增\\n取排水相關海事工程，故 進行模擬時以最大量 152 CMS之最不利條件進行\\n模擬。  \\n經溫排水溫升近域模擬及遠域模擬評估後 (模式說明及驗證請參見 附\\n錄22)，距排放口 500 公尺處之綜合溫升在各種潮位及流況下均不會超過\\n4℃，如表7.2-1所示，距離排放口 500公尺處綜合溫升介於 2.67°C \\n~3.28 °C，符合環保署水污染防治法「放流水標準」之溫差規定。 詳圖7.2-1\\n及圖7.2-2。 '"
      ]
     },
     "execution_count": 117,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pdfReader.pages[72].extract_text()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "id": "0c4c0bb1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['7.1  物理及化學環境',\n",
       " '7.1.1 地形及地質',\n",
       " '1.土壤改良',\n",
       " '2.基礎型式選擇或處理',\n",
       " '3.管線型式選擇',\n",
       " '7.1.2 斷層及地震',\n",
       " '一、地震',\n",
       " '二、斷層',\n",
       " '7.1.3 土壤',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.1.4 空氣品質',\n",
       " '一、空氣品質模擬',\n",
       " '(一)施工期間',\n",
       " '1.評估條件',\n",
       " '2.影響分析',\n",
       " '(1)氣狀污染物 (SO 2、NO 2、CO)',\n",
       " '(2)粒狀污染物 (TSP、PM 10、PM 2.5).',\n",
       " '(3)運輸道路路緣影響分析',\n",
       " '2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。',\n",
       " '2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。',\n",
       " '(二)營運期間',\n",
       " '1.本計畫燃氣機組排放量',\n",
       " '(1)興達電廠全廠空污排放量計算',\n",
       " '2.考量未來持續成長之電力需求，在符合排放標準及空污總量管制前提下，將既有廠區做整體性規劃，以充分最佳化利用空間。',\n",
       " '3.既有廠區於機組除役後的削減總量差額，將依總 量管制保留抵換辦法規定申請保留，視未來電力供應需求使用。',\n",
       " '4.依據台灣中油公司 之天然氣最大含硫量規範，硫氧化物濃度 推估為 0.8 ppm。',\n",
       " '5.107年後之燃煤機組空污排放量計算係以生煤許可量進行估算，並已考量空污改善效益。',\n",
       " '(C) 全廠排',\n",
       " '(A) 燃氣',\n",
       " '(B)',\n",
       " '(2)興達電廠全廠空污控管機制',\n",
       " 'A.空污控制對策',\n",
       " 'a.生煤使用量控管',\n",
       " 'b. 既有發電機組空污改善',\n",
       " 'c.既有發電機組操作調配減排',\n",
       " 'd.既有發電機組汰舊換新',\n",
       " 'B.空污控管機制',\n",
       " '2.原生性空氣污染物影響分析',\n",
       " '(1)氣狀污染物 (SO 2、NO 2)',\n",
       " '(2)粒狀污染物 (TSP、PM 10、PM 2.5)',\n",
       " '(3)運輸道路路緣影響分析',\n",
       " '2.PM 10、PM 2.5、SO 2、NO 2各時段背景濃度為環保署橋頭測站民國 104～106年之 3年平均值。',\n",
       " '2.PM 10、PM 2.5、SO 2、NO 2各時段背景濃度為環保署橋頭測站民國 104～106年之 3年平均值。',\n",
       " '2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。',\n",
       " '2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。',\n",
       " '3.衍生性空氣污染物影響分析',\n",
       " '(1)模式設定及輸入資料',\n",
       " 'A.使用模式',\n",
       " 'B.模擬案例選擇',\n",
       " '9.0排放量資料 (基準為民國 102年)，並依據環保署公告南部地',\n",
       " 'C.模擬範圍與網格解析度',\n",
       " 'D.氣象資料',\n",
       " 'E.邊界條件與初始條件',\n",
       " 'F.排放量資料',\n",
       " '(a)基準排放資料',\n",
       " '(b)本計畫新 機組排放量',\n",
       " '(1)基準模擬結果與模式性能評估',\n",
       " '(2)臭氧評估結果',\n",
       " '(3)PM 10及PM 2.5評估結果',\n",
       " '(4)新舊燃氣機組空品抵換 評估',\n",
       " '(三)營運期間舊廠區五部燃氣機組等設備 拆卸工程',\n",
       " '1.評估條件',\n",
       " '2.影響分析',\n",
       " '(1)氣狀污染物 (SO 2、NO 2、CO)',\n",
       " '(2)粒狀污染物 (TSP、PM 10、PM 2.5)',\n",
       " '(3)運輸道路路緣影響分析',\n",
       " '5.NO 2增量濃度包含營運期間舊廠區五部燃氣機組等設備拆卸工程與新燃氣機組運轉之增量。',\n",
       " '5. NO 2增量濃度包含營運期間舊廠區五部燃氣機組拆卸工程與新燃氣機組運轉之增量。',\n",
       " '2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。',\n",
       " '5.NO 2增量濃度包含營運期間舊廠區五部燃氣機組拆卸工程與新燃氣機組運轉之增量。',\n",
       " '2.TSP背景濃度為民國 106年本電廠周邊環境監測結果最大值。',\n",
       " '二、溫室氣體排放量推估',\n",
       " '(一)施工期間之溫室氣體排放量',\n",
       " '1.施工機具',\n",
       " '2.化糞池 (水肥 )',\n",
       " '(二)營運期間之溫室氣體排放量',\n",
       " '1.依據台灣中油股份有限公司天然氣事業部之物質安全資料表天然氣',\n",
       " '(2)，天然氣密度為 0.75 kg/m3，因此，天然氣使用量 (m3/年)= 480噸/',\n",
       " '2.依據興達電廠燃氣機組更新改建計畫可行性研究報告，天然氣熱值',\n",
       " '2.0831461081 kgCO 2/m3，甲烷 (CH 4)',\n",
       " '3.全球溫暖化潛勢 (Global Warming Potential, GWP ) 分別為',\n",
       " '1. CO 2溫室氣體排放當量為 992.71萬噸 CO 2e/年',\n",
       " '2. CH 4溫室氣體排放當量為 0.44萬噸 CO 2e/年',\n",
       " '3. N2O溫室氣體排放當量為 0.53萬噸 CO 2e/年',\n",
       " '4. 溫室氣體排放量為 993.68萬噸 CO 2e/年',\n",
       " '(三)評估各階段溫室氣體排放量',\n",
       " '2.115年溫室氣體排放量達到峰值，因需待新機組順利運轉後啟動舊機組除役；燃煤機組除役後即可',\n",
       " '三、本計畫節能 減碳規劃',\n",
       " '2. 營運中心 及備勤宿舍等符合「綠建築推動方案」規定',\n",
       " '7.1.5 噪音與振動',\n",
       " '一、噪音',\n",
       " '(一)施工噪音',\n",
       " '1.噪音主要影響區位',\n",
       " '2.噪音影響評估基準',\n",
       " '3.評估模式說明',\n",
       " '4.施工期間噪音影響預測',\n",
       " '(1)工作面施工機具種類及數量',\n",
       " '(2)施工噪音',\n",
       " '(3)運輸車次噪音',\n",
       " '(二)營運期間噪音影響預測',\n",
       " '1.電廠營運噪音',\n",
       " '(1)噪音主要影響區位',\n",
       " '(2)噪音影響評估基準',\n",
       " '(3)評估模式說明',\n",
       " '(4)噪音影響預測',\n",
       " '(5)道路交通噪音',\n",
       " '2. 舊廠區五部 燃氣機組等設備 拆除施工噪音評估',\n",
       " '(1)噪音主要影響區位',\n",
       " '(2)噪音影響評估基準',\n",
       " '(3)評估模式說明',\n",
       " '(4)噪音影響預測',\n",
       " '(5)道路交通噪音',\n",
       " '二、振動',\n",
       " '(一)振動主要影響區位',\n",
       " '(二)本計畫振動來源',\n",
       " '(三)模式說明',\n",
       " '(四)振動影響預測',\n",
       " '1.施工期間振動',\n",
       " '(1)施工機具振動影響',\n",
       " '(2)施工運輸車輛振動影響',\n",
       " '2.營運期間振動',\n",
       " '(1)電廠營運期間交通運輸振動',\n",
       " '(2)電廠營運及 舊廠區五部 燃氣機組等設備拆除 作業交通運輸振動',\n",
       " '7.1.6 水文水質',\n",
       " '一、水文',\n",
       " '(一)施工期間',\n",
       " '(二)營運期間',\n",
       " '二、水質',\n",
       " '(一)施工期間',\n",
       " '1.施工區域地表 逕流廢水',\n",
       " '2.施工廢水及人員生活污水',\n",
       " '3.施工期間對承受水體之非點源污染模擬',\n",
       " '(二)營運期間',\n",
       " '1.電廠綜合廢水',\n",
       " '2.員工生活污水',\n",
       " '7.1.7 海域水質',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.1.8 廢棄物',\n",
       " '一、施工期間',\n",
       " '(一)工程廢料',\n",
       " '(二)施工人員生活廢棄物',\n",
       " '(三)既有燃氣機組 拆除衍生之廢棄物',\n",
       " '1.一般事業廢棄物',\n",
       " '2.公告應回收或再利用廢棄物',\n",
       " '3.混合五金廢料',\n",
       " '4.營建廢棄物',\n",
       " '二、營運期間',\n",
       " '7.2  溫排水擴散模擬',\n",
       " '一、本計畫溫排水擴散模擬',\n",
       " '二、鄰近海域長期溫升監測結果驗證',\n",
       " '7.3  生態環境',\n",
       " '7.3.1 陸域植物',\n",
       " '一、施工期間',\n",
       " '(一)棲地損失',\n",
       " '(二) 物種衝擊',\n",
       " '二、營運期間',\n",
       " '(一)棲地與生物相改變',\n",
       " '(二)增加外來植物入侵潛勢',\n",
       " '7.3.2 陸域動物',\n",
       " '一、施工期間',\n",
       " '(一)棲地環境衝擊評估',\n",
       " '1.永安濕地 鄰近基地約 500公尺，會有直接的各類施工擾動，推測較',\n",
       " '2.計畫區鄰近永安濕地，計畫區南側施工時機具、運輸車輛噪音合成',\n",
       " '3.周邊人為擾動增加 (噪音及光害 )，可能僅有對人為干擾耐受度較高的',\n",
       " '4.施工揚塵可能影響水質，會對依賴水域環境的水鳥、蜻蜓 (包含稚蟲 )',\n",
       " '(二)保育類等關注物種之衝擊評估',\n",
       " '(一)彩鷸',\n",
       " '(二)魚鷹',\n",
       " '(三)紅隼',\n",
       " '(四)小燕鷗',\n",
       " '(五)紅尾伯勞',\n",
       " '二、營運期間',\n",
       " '(一)保育類等關注物種衝擊評估',\n",
       " '1.彩鷸',\n",
       " '2.魚鷹',\n",
       " '3.紅隼',\n",
       " '4.小燕鷗',\n",
       " '5.紅尾伯勞',\n",
       " '(二)永安重要濕地保育利用計畫',\n",
       " '1.保育利用計畫範圍',\n",
       " '2.計畫年期',\n",
       " '3.計畫目標',\n",
       " 'a.確保濕地生態功能，營造維護濕地環境，提供穩定棲地以維護生',\n",
       " 'b.維護濕地滯洪功能，規劃合宜之功能分區，落實濕地明智利用目',\n",
       " 'c.結合濕地生態資源、周邊曬鹽文化聚落與遊憩功能，推動永續環',\n",
       " '4.保育利用計畫經費',\n",
       " 'A.將採低度開發，以維持地形、地貌及生態原貌。',\n",
       " 'B.維持至少一定水深，提供部分水鳥覓食與棲息。',\n",
       " 'C.若需開發規劃，將以生態公園 、步道、運動場',\n",
       " '7.3.3 水域生態',\n",
       " '7.3.4 海域生態',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.3.5 電廠歷年監測數據分析',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.3.6 電廠汲入海水 造成當地漁業資源損失評估',\n",
       " '1.汲入量及對當地漁業資源損失評估',\n",
       " '1.84×107 個/year。',\n",
       " '2. 撞擊濾網損失評估',\n",
       " '3.溫排水影響評估',\n",
       " '4.結論',\n",
       " '7.4  景觀及遊憩環境',\n",
       " '7.4.1  開發行為景觀現況美質影響調查與評估',\n",
       " '一、開發行為景觀現況美質影響調查',\n",
       " '(一)開發行為範圍與其影 響全區視域範圍',\n",
       " '(二)開發行為景觀控制點 (景觀點 )選取',\n",
       " '(三)現地環境景觀美質分析',\n",
       " '二、開發行為景觀影響預測',\n",
       " '(一)開發行為模擬操作',\n",
       " '(二)景觀影響預測',\n",
       " '7.4.2 遊憩環境',\n",
       " '一、開發行為影響預測',\n",
       " '(一)施工期間的遊憩影響預測',\n",
       " '1.施工影響遊憩據點的交通可及性',\n",
       " '2.施工影響鄰近遊憩據點的遊憩體驗',\n",
       " '(二)完工營運期間的遊憩影響預測',\n",
       " '1.燃氣機組設置後的視覺影響',\n",
       " '二、可能影響遊憩點預測與評估',\n",
       " '(一)興達港 /情人碼頭',\n",
       " '(二)茄萣濕地公園',\n",
       " '(三)永安濕地',\n",
       " '(四)大崗山風景區',\n",
       " '(五)鹽田彩繪村',\n",
       " '(六)漯底山自然公園',\n",
       " '三、遊憩影響綜合評估',\n",
       " '1.興達港 /情人碼頭',\n",
       " '2.茄萣濕地公園',\n",
       " '3.永安濕地',\n",
       " '4.大崗山風景區',\n",
       " '5.鹽田彩繪村',\n",
       " '6.漯底山自然公園',\n",
       " '7.4.3 概念設計國際競圖',\n",
       " '7.5  社會經濟環境',\n",
       " '7.5.1 土地利用',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.5.2 人口特性',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.5.3 就業機會與產業結構',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.5.4 公共設施 服務',\n",
       " '一、施工期間',\n",
       " '二、營運期間',\n",
       " '7.5.5 交通運輸',\n",
       " '一、施工期間',\n",
       " '(一)施工人員',\n",
       " '(二)施工車輛',\n",
       " '(三)管線開挖',\n",
       " '(四)衝擊評估',\n",
       " '(五)降低交通影響及維護安全措施',\n",
       " '1.大型車輛車體大，轉彎內外輪差亦大，影響駕駛本身及其他用路人',\n",
       " '2.大型車輛車身載重大，重心高，影響行車穩定性及停車視距。由於',\n",
       " '3.車輛行駛於路面對道路破壞力與車速、載重成正比，大型車 輛有較',\n",
       " '4.大型車輛及其駕駛較易有疲勞駕駛的問題，因此載運車輛應定期實',\n",
       " '(六)新增施工臨時替代道路',\n",
       " '二、營運期間',\n",
       " '(一) 營運人力',\n",
       " '(二) 舊廠區五部 燃氣機組等設備拆除作業 施工車輛',\n",
       " '(三) 衝擊評估',\n",
       " '(四)降低交通影響及維護安全措施',\n",
       " '7.5.6  應用熱電共生系統供應區域冷熱需求評估',\n",
       " '一、供應附近工業區可行性',\n",
       " '二、供應附近社區可行性',\n",
       " '7.6  文化資產',\n",
       " '一、本案 開發對鹽場遺跡文資影響評估',\n",
       " '二、塔加里揚 戰役地點與開發基地的關聯評估',\n",
       " '7.7  天然氣管線 安全分析',\n",
       " '一、  廠區外輸氣管線',\n",
       " '二、廠區內安全措施',\n",
       " '(一)興達發電廠天然氣供氣專管自台灣中油公司永安液化天然氣廠至本計畫',\n",
       " '(二)興達發電廠相關部門依據運轉保養維護工作項目 ，分工執行維護及巡視',\n",
       " '(三)前項巡視、保養維護檢查相關作業紀錄包括',\n",
       " '1.每日從台 灣中油公司永安液化天然氣廠至本廠所屬之地上管線執行',\n",
       " '2.每季在輸氣專管沿線測電站量測電位，填寫 ，「天然氣管線陰極防蝕',\n",
       " '(四)另本廠訂定相關操作管理要點包括',\n",
       " '2.興達發電廠天然氣專管破漏緊急應變作業辦法。',\n",
       " '(五)新設之天然氣輸氣管路 之安全設備及災害預防措施',\n",
       " '1.本計畫天然氣供氣管線未來將裝置音波測漏之監測系統，以及人工',\n",
       " '2.廠區天然氣管路自計量站經減壓站至氣渦輪機組之適當位置設有',\n",
       " '3.廠內可能密閉 區域將裝設天然氣濃度偵測器 及通風設備以避免天然',\n",
       " '4.燃燒區域防爆隔離、洩漏、偵測，將於規範中明訂各相關法規之要',\n",
       " '三、廠區內輸氣管線',\n",
       " '(一)災害發生條件天然氣災害發生條件必需具備下列三個條件',\n",
       " '1.第一個條件是有漏氣現象；',\n",
       " '2.第二個條件是漏出氣體被收集於密閉物體或場所中，無法溢散至大',\n",
       " '3.第三個條件是有火花產生，因而造成火災或爆炸，或人員進入高濃',\n",
       " '(二) 減輕影響說明',\n",
       " '7.8 健康風險評估']"
      ]
     },
     "execution_count": 142,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "p=3\n",
    "outlines#[30*p:30*(p+1)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "id": "8c3aee03",
   "metadata": {},
   "outputs": [],
   "source": [
    "run pp.py 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "id": "7049e908",
   "metadata": {},
   "outputs": [],
   "source": [
    "fname=\"D:\\E\\My Documents\\EIAs\\電廠\\GAS_EIA\\(1070401A) 興達電廠燃氣機組更新改建計畫環境影響說明書\\C07outlineR.txt\"\n",
    "with open(fname,'r') as f:\n",
    "    lines=[l.strip().replace('\\n','') for l in f]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 253,
   "id": "bcdb1bdd",
   "metadata": {},
   "outputs": [],
   "source": [
    "from pandas import *\n",
    "df=DataFrame({})\n",
    "df['tit']=lines\n",
    "df['lev']=0\n",
    "df.loc[df.tit.map(lambda x:x.count('.')==2 and x[0].isdigit() and x[2].isdigit() and x[4].isdigit()),'lev']=2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 254,
   "id": "767faef9",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[2].isdigit() and x[1]=='.')),'lev']=1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 255,
   "id": "12225664",
   "metadata": {},
   "outputs": [],
   "source": [
    "chnum=['一','二','三','四','五','六','七','八','九','十',]\n",
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[0] in chnum)),'lev']=3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 256,
   "id": "1a1df13b",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[1] in chnum)),'lev']=4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 257,
   "id": "d8a37451",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[0].isdigit())),'lev']=5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 258,
   "id": "88eaf93d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[1].isdigit() and x[0]=='(' and x[2]==')')),'lev']=6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 259,
   "id": "f97c514a",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[0].isupper())),'lev']=7\n",
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[1].isupper() and x[0]=='(' and x[2]==')')),'lev']=8\n",
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[0].islower())),'lev']=9\n",
    "df.loc[(df.lev==0)&(df.tit.map(lambda x:x[1].islower() and x[0]=='(' and x[2]==')')),'lev']=10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 260,
   "id": "78812e15",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['id']=df.index\n",
    "df.lev=df.lev-1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 213,
   "id": "13c1de17",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tit</th>\n",
       "      <th>lev</th>\n",
       "      <th>id</th>\n",
       "      <th>parent_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7.1  物理及化學環境</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>7.1.1 地形及地質</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.土壤改良</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2.基礎型式選擇或處理</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3.管線型式選擇</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>256</th>\n",
       "      <td>1.第一個條件是有漏氣現象；</td>\n",
       "      <td>4</td>\n",
       "      <td>256</td>\n",
       "      <td>255</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>257</th>\n",
       "      <td>2.第二個條件是漏出氣體被收集於密閉物體或場所中，無法溢散至大</td>\n",
       "      <td>4</td>\n",
       "      <td>257</td>\n",
       "      <td>256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>258</th>\n",
       "      <td>3.第三個條件是有火花產生，因而造成火災或爆炸，或人員進入高濃</td>\n",
       "      <td>4</td>\n",
       "      <td>258</td>\n",
       "      <td>257</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>259</th>\n",
       "      <td>(二) 減輕影響說明</td>\n",
       "      <td>3</td>\n",
       "      <td>259</td>\n",
       "      <td>258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>260</th>\n",
       "      <td>7.8 健康風險評估</td>\n",
       "      <td>0</td>\n",
       "      <td>260</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>261 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 tit  lev   id parent_id\n",
       "0                       7.1  物理及化學環境    0    0      None\n",
       "1                        7.1.1 地形及地質    1    1         0\n",
       "2                             1.土壤改良    4    2         1\n",
       "3                        2.基礎型式選擇或處理    4    3         2\n",
       "4                           3.管線型式選擇    4    4         3\n",
       "..                               ...  ...  ...       ...\n",
       "256                   1.第一個條件是有漏氣現象；    4  256       255\n",
       "257  2.第二個條件是漏出氣體被收集於密閉物體或場所中，無法溢散至大    4  257       256\n",
       "258  3.第三個條件是有火花產生，因而造成火災或爆炸，或人員進入高濃    4  258       257\n",
       "259                       (二) 減輕影響說明    3  259       258\n",
       "260                       7.8 健康風險評估    0  260      None\n",
       "\n",
       "[261 rows x 4 columns]"
      ]
     },
     "execution_count": 213,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['parent_id'] = None\n",
    "for index, row in df.iterrows():\n",
    "    if row['lev'] > 0:\n",
    "        parent_row = df.loc[df['id'] == row['id'] - 1]\n",
    "        if not parent_row.empty:\n",
    "            df.at[index, 'parent_id'] = parent_row['id'].values[0]\n",
    "df            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 320,
   "id": "cbcf8f02",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['parent_id'] = None\n",
    "mnlev,mxlev=df.lev.min(),df.lev.max()\n",
    "for l in range(mnlev,mxlev):\n",
    "    a=df.loc[df.lev==l]\n",
    "    n=len(a)\n",
    "    if n==0:continue\n",
    "    ai=list(a.index)\n",
    "    aj=ai[1:]+[len(df)]\n",
    "    b=df.loc[(df.lev>l) & (df.parent_id.isnull())] \n",
    "    for i in range(n):\n",
    "        boo=(b.index>ai[i]) & (b.index<aj[i] )\n",
    "        c=b.loc[boo]\n",
    "        mn=c.lev.min()\n",
    "        df.loc[c.loc[c.lev==mn].index,'parent_id']=ai[i]        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 311,
   "id": "a80900d5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tit</th>\n",
       "      <th>lev</th>\n",
       "      <th>id</th>\n",
       "      <th>parent_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [tit, lev, id, parent_id]\n",
       "Index: []"
      ]
     },
     "execution_count": 311,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 313,
   "id": "c7676829",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tit</th>\n",
       "      <th>lev</th>\n",
       "      <th>id</th>\n",
       "      <th>parent_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [tit, lev, id, parent_id]\n",
       "Index: []"
      ]
     },
     "execution_count": 313,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.loc[df.lev==l]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 296,
   "id": "0dfb8a18",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tit</th>\n",
       "      <th>lev</th>\n",
       "      <th>id</th>\n",
       "      <th>parent_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>7.1.1 地形及地質</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>7.1.2 斷層及地震</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>7.1.3 土壤</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>7.1.4 空氣品質</td>\n",
       "      <td>1</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>7.1.5 噪音與振動</td>\n",
       "      <td>1</td>\n",
       "      <td>63</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>7.1.6 水文水質</td>\n",
       "      <td>1</td>\n",
       "      <td>97</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>109</th>\n",
       "      <td>7.1.7 海域水質</td>\n",
       "      <td>1</td>\n",
       "      <td>109</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112</th>\n",
       "      <td>7.1.8 廢棄物</td>\n",
       "      <td>1</td>\n",
       "      <td>112</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>7.3.1 陸域植物</td>\n",
       "      <td>1</td>\n",
       "      <td>126</td>\n",
       "      <td>125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>133</th>\n",
       "      <td>7.3.2 陸域動物</td>\n",
       "      <td>1</td>\n",
       "      <td>133</td>\n",
       "      <td>125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>157</th>\n",
       "      <td>7.3.3 水域生態</td>\n",
       "      <td>1</td>\n",
       "      <td>157</td>\n",
       "      <td>125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>158</th>\n",
       "      <td>7.3.4 海域生態</td>\n",
       "      <td>1</td>\n",
       "      <td>158</td>\n",
       "      <td>125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>161</th>\n",
       "      <td>7.3.5 電廠歷年監測數據分析</td>\n",
       "      <td>1</td>\n",
       "      <td>161</td>\n",
       "      <td>125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>164</th>\n",
       "      <td>7.3.6 電廠汲入海水 造成當地漁業資源損失評估</td>\n",
       "      <td>1</td>\n",
       "      <td>164</td>\n",
       "      <td>125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>174</th>\n",
       "      <td>7.4.1  開發行為景觀現況美質影響調查與評估</td>\n",
       "      <td>1</td>\n",
       "      <td>174</td>\n",
       "      <td>173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>182</th>\n",
       "      <td>7.4.2 遊憩環境</td>\n",
       "      <td>1</td>\n",
       "      <td>182</td>\n",
       "      <td>173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203</th>\n",
       "      <td>7.4.3 概念設計國際競圖</td>\n",
       "      <td>1</td>\n",
       "      <td>203</td>\n",
       "      <td>173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205</th>\n",
       "      <td>7.5.1 土地利用</td>\n",
       "      <td>1</td>\n",
       "      <td>205</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208</th>\n",
       "      <td>7.5.2 人口特性</td>\n",
       "      <td>1</td>\n",
       "      <td>208</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>211</th>\n",
       "      <td>7.5.3 就業機會與產業結構</td>\n",
       "      <td>1</td>\n",
       "      <td>211</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>214</th>\n",
       "      <td>7.5.4 公共設施 服務</td>\n",
       "      <td>1</td>\n",
       "      <td>214</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>217</th>\n",
       "      <td>7.5.5 交通運輸</td>\n",
       "      <td>1</td>\n",
       "      <td>217</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>234</th>\n",
       "      <td>7.5.6  應用熱電共生系統供應區域冷熱需求評估</td>\n",
       "      <td>1</td>\n",
       "      <td>234</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                           tit  lev   id parent_id\n",
       "1                  7.1.1 地形及地質    1    1         0\n",
       "5                  7.1.2 斷層及地震    1    5         0\n",
       "8                     7.1.3 土壤    1    8         0\n",
       "11                  7.1.4 空氣品質    1   11         0\n",
       "63                 7.1.5 噪音與振動    1   63         0\n",
       "97                  7.1.6 水文水質    1   97         0\n",
       "109                 7.1.7 海域水質    1  109         0\n",
       "112                  7.1.8 廢棄物    1  112         0\n",
       "126                 7.3.1 陸域植物    1  126       125\n",
       "133                 7.3.2 陸域動物    1  133       125\n",
       "157                 7.3.3 水域生態    1  157       125\n",
       "158                 7.3.4 海域生態    1  158       125\n",
       "161           7.3.5 電廠歷年監測數據分析    1  161       125\n",
       "164  7.3.6 電廠汲入海水 造成當地漁業資源損失評估    1  164       125\n",
       "174   7.4.1  開發行為景觀現況美質影響調查與評估    1  174       173\n",
       "182                 7.4.2 遊憩環境    1  182       173\n",
       "203             7.4.3 概念設計國際競圖    1  203       173\n",
       "205                 7.5.1 土地利用    1  205       204\n",
       "208                 7.5.2 人口特性    1  208       204\n",
       "211            7.5.3 就業機會與產業結構    1  211       204\n",
       "214              7.5.4 公共設施 服務    1  214       204\n",
       "217                 7.5.5 交通運輸    1  217       204\n",
       "234  7.5.6  應用熱電共生系統供應區域冷熱需求評估    1  234       204"
      ]
     },
     "execution_count": 296,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.loc[(df.lev==1)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 302,
   "id": "c8585c76",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tit</th>\n",
       "      <th>lev</th>\n",
       "      <th>id</th>\n",
       "      <th>parent_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7.1  物理及化學環境</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>7.2  溫排水擴散模擬</td>\n",
       "      <td>0</td>\n",
       "      <td>122</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>7.3  生態環境</td>\n",
       "      <td>0</td>\n",
       "      <td>125</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>173</th>\n",
       "      <td>7.4  景觀及遊憩環境</td>\n",
       "      <td>0</td>\n",
       "      <td>173</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204</th>\n",
       "      <td>7.5  社會經濟環境</td>\n",
       "      <td>0</td>\n",
       "      <td>204</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>235</th>\n",
       "      <td>一、供應附近工業區可行性</td>\n",
       "      <td>2</td>\n",
       "      <td>235</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>236</th>\n",
       "      <td>二、供應附近社區可行性</td>\n",
       "      <td>2</td>\n",
       "      <td>236</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>237</th>\n",
       "      <td>7.6  文化資產</td>\n",
       "      <td>0</td>\n",
       "      <td>237</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>240</th>\n",
       "      <td>7.7  天然氣管線 安全分析</td>\n",
       "      <td>0</td>\n",
       "      <td>240</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>255</th>\n",
       "      <td>(一)災害發生條件天然氣災害發生條件必需具備下列三個條件</td>\n",
       "      <td>3</td>\n",
       "      <td>255</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>259</th>\n",
       "      <td>(二) 減輕影響說明</td>\n",
       "      <td>3</td>\n",
       "      <td>259</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>260</th>\n",
       "      <td>7.8 健康風險評估</td>\n",
       "      <td>0</td>\n",
       "      <td>260</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                              tit  lev   id parent_id\n",
       "0                    7.1  物理及化學環境    0    0      None\n",
       "122                  7.2  溫排水擴散模擬    0  122      None\n",
       "125                     7.3  生態環境    0  125      None\n",
       "173                  7.4  景觀及遊憩環境    0  173      None\n",
       "204                   7.5  社會經濟環境    0  204      None\n",
       "235                  一、供應附近工業區可行性    2  235      None\n",
       "236                   二、供應附近社區可行性    2  236      None\n",
       "237                     7.6  文化資產    0  237      None\n",
       "240               7.7  天然氣管線 安全分析    0  240      None\n",
       "255  (一)災害發生條件天然氣災害發生條件必需具備下列三個條件    3  255      None\n",
       "259                    (二) 減輕影響說明    3  259      None\n",
       "260                    7.8 健康風險評估    0  260      None"
      ]
     },
     "execution_count": 302,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.loc[df.parent_id.isnull()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 321,
   "id": "97761372",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tit</th>\n",
       "      <th>lev</th>\n",
       "      <th>id</th>\n",
       "      <th>parent_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>180</th>\n",
       "      <td>(一)開發行為模擬操作</td>\n",
       "      <td>3</td>\n",
       "      <td>180</td>\n",
       "      <td>179</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>181</th>\n",
       "      <td>(二)景觀影響預測</td>\n",
       "      <td>3</td>\n",
       "      <td>181</td>\n",
       "      <td>179</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>182</th>\n",
       "      <td>7.4.2 遊憩環境</td>\n",
       "      <td>1</td>\n",
       "      <td>182</td>\n",
       "      <td>173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183</th>\n",
       "      <td>一、開發行為影響預測</td>\n",
       "      <td>2</td>\n",
       "      <td>183</td>\n",
       "      <td>182</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>184</th>\n",
       "      <td>(一)施工期間的遊憩影響預測</td>\n",
       "      <td>3</td>\n",
       "      <td>184</td>\n",
       "      <td>183</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>185</th>\n",
       "      <td>1.施工影響遊憩據點的交通可及性</td>\n",
       "      <td>4</td>\n",
       "      <td>185</td>\n",
       "      <td>184</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>186</th>\n",
       "      <td>2.施工影響鄰近遊憩據點的遊憩體驗</td>\n",
       "      <td>4</td>\n",
       "      <td>186</td>\n",
       "      <td>184</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>187</th>\n",
       "      <td>(二)完工營運期間的遊憩影響預測</td>\n",
       "      <td>3</td>\n",
       "      <td>187</td>\n",
       "      <td>183</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>188</th>\n",
       "      <td>1.燃氣機組設置後的視覺影響</td>\n",
       "      <td>4</td>\n",
       "      <td>188</td>\n",
       "      <td>187</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>189</th>\n",
       "      <td>二、可能影響遊憩點預測與評估</td>\n",
       "      <td>2</td>\n",
       "      <td>189</td>\n",
       "      <td>182</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>190</th>\n",
       "      <td>(一)興達港 /情人碼頭</td>\n",
       "      <td>3</td>\n",
       "      <td>190</td>\n",
       "      <td>189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>191</th>\n",
       "      <td>(二)茄萣濕地公園</td>\n",
       "      <td>3</td>\n",
       "      <td>191</td>\n",
       "      <td>189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>192</th>\n",
       "      <td>(三)永安濕地</td>\n",
       "      <td>3</td>\n",
       "      <td>192</td>\n",
       "      <td>189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>193</th>\n",
       "      <td>(四)大崗山風景區</td>\n",
       "      <td>3</td>\n",
       "      <td>193</td>\n",
       "      <td>189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>194</th>\n",
       "      <td>(五)鹽田彩繪村</td>\n",
       "      <td>3</td>\n",
       "      <td>194</td>\n",
       "      <td>189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>195</th>\n",
       "      <td>(六)漯底山自然公園</td>\n",
       "      <td>3</td>\n",
       "      <td>195</td>\n",
       "      <td>189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>三、遊憩影響綜合評估</td>\n",
       "      <td>2</td>\n",
       "      <td>196</td>\n",
       "      <td>182</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>1.興達港 /情人碼頭</td>\n",
       "      <td>4</td>\n",
       "      <td>197</td>\n",
       "      <td>196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>198</th>\n",
       "      <td>2.茄萣濕地公園</td>\n",
       "      <td>4</td>\n",
       "      <td>198</td>\n",
       "      <td>196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>3.永安濕地</td>\n",
       "      <td>4</td>\n",
       "      <td>199</td>\n",
       "      <td>196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>4.大崗山風景區</td>\n",
       "      <td>4</td>\n",
       "      <td>200</td>\n",
       "      <td>196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201</th>\n",
       "      <td>5.鹽田彩繪村</td>\n",
       "      <td>4</td>\n",
       "      <td>201</td>\n",
       "      <td>196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202</th>\n",
       "      <td>6.漯底山自然公園</td>\n",
       "      <td>4</td>\n",
       "      <td>202</td>\n",
       "      <td>196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203</th>\n",
       "      <td>7.4.3 概念設計國際競圖</td>\n",
       "      <td>1</td>\n",
       "      <td>203</td>\n",
       "      <td>173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204</th>\n",
       "      <td>7.5  社會經濟環境</td>\n",
       "      <td>0</td>\n",
       "      <td>204</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205</th>\n",
       "      <td>7.5.1 土地利用</td>\n",
       "      <td>1</td>\n",
       "      <td>205</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>206</td>\n",
       "      <td>205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207</th>\n",
       "      <td>二、營運期間</td>\n",
       "      <td>2</td>\n",
       "      <td>207</td>\n",
       "      <td>205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208</th>\n",
       "      <td>7.5.2 人口特性</td>\n",
       "      <td>1</td>\n",
       "      <td>208</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>209</td>\n",
       "      <td>208</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210</th>\n",
       "      <td>二、營運期間</td>\n",
       "      <td>2</td>\n",
       "      <td>210</td>\n",
       "      <td>208</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>211</th>\n",
       "      <td>7.5.3 就業機會與產業結構</td>\n",
       "      <td>1</td>\n",
       "      <td>211</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>212</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>212</td>\n",
       "      <td>211</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>213</th>\n",
       "      <td>二、營運期間</td>\n",
       "      <td>2</td>\n",
       "      <td>213</td>\n",
       "      <td>211</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>214</th>\n",
       "      <td>7.5.4 公共設施 服務</td>\n",
       "      <td>1</td>\n",
       "      <td>214</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>215</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>215</td>\n",
       "      <td>214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>216</th>\n",
       "      <td>二、營運期間</td>\n",
       "      <td>2</td>\n",
       "      <td>216</td>\n",
       "      <td>214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>217</th>\n",
       "      <td>7.5.5 交通運輸</td>\n",
       "      <td>1</td>\n",
       "      <td>217</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>218</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>218</td>\n",
       "      <td>217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>219</th>\n",
       "      <td>(一)施工人員</td>\n",
       "      <td>3</td>\n",
       "      <td>219</td>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>220</th>\n",
       "      <td>(二)施工車輛</td>\n",
       "      <td>3</td>\n",
       "      <td>220</td>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>221</th>\n",
       "      <td>(三)管線開挖</td>\n",
       "      <td>3</td>\n",
       "      <td>221</td>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>222</th>\n",
       "      <td>(四)衝擊評估</td>\n",
       "      <td>3</td>\n",
       "      <td>222</td>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>223</th>\n",
       "      <td>(五)降低交通影響及維護安全措施</td>\n",
       "      <td>3</td>\n",
       "      <td>223</td>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>224</th>\n",
       "      <td>1.大型車輛車體大，轉彎內外輪差亦大，影響駕駛本身及其他用路人</td>\n",
       "      <td>4</td>\n",
       "      <td>224</td>\n",
       "      <td>223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>225</th>\n",
       "      <td>2.大型車輛車身載重大，重心高，影響行車穩定性及停車視距。由於</td>\n",
       "      <td>4</td>\n",
       "      <td>225</td>\n",
       "      <td>223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>226</th>\n",
       "      <td>3.車輛行駛於路面對道路破壞力與車速、載重成正比，大型車 輛有較</td>\n",
       "      <td>4</td>\n",
       "      <td>226</td>\n",
       "      <td>223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>227</th>\n",
       "      <td>4.大型車輛及其駕駛較易有疲勞駕駛的問題，因此載運車輛應定期實</td>\n",
       "      <td>4</td>\n",
       "      <td>227</td>\n",
       "      <td>223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>(六)新增施工臨時替代道路</td>\n",
       "      <td>3</td>\n",
       "      <td>228</td>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229</th>\n",
       "      <td>二、營運期間</td>\n",
       "      <td>2</td>\n",
       "      <td>229</td>\n",
       "      <td>217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>230</th>\n",
       "      <td>(一) 營運人力</td>\n",
       "      <td>3</td>\n",
       "      <td>230</td>\n",
       "      <td>229</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>(二) 舊廠區五部 燃氣機組等設備拆除作業 施工車輛</td>\n",
       "      <td>3</td>\n",
       "      <td>231</td>\n",
       "      <td>229</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>232</th>\n",
       "      <td>(三) 衝擊評估</td>\n",
       "      <td>3</td>\n",
       "      <td>232</td>\n",
       "      <td>229</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233</th>\n",
       "      <td>(四)降低交通影響及維護安全措施</td>\n",
       "      <td>3</td>\n",
       "      <td>233</td>\n",
       "      <td>229</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>234</th>\n",
       "      <td>7.5.6  應用熱電共生系統供應區域冷熱需求評估</td>\n",
       "      <td>1</td>\n",
       "      <td>234</td>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>235</th>\n",
       "      <td>一、供應附近工業區可行性</td>\n",
       "      <td>2</td>\n",
       "      <td>235</td>\n",
       "      <td>234</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>236</th>\n",
       "      <td>二、供應附近社區可行性</td>\n",
       "      <td>2</td>\n",
       "      <td>236</td>\n",
       "      <td>234</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>237</th>\n",
       "      <td>7.6  文化資產</td>\n",
       "      <td>0</td>\n",
       "      <td>237</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>238</th>\n",
       "      <td>一、本案 開發對鹽場遺跡文資影響評估</td>\n",
       "      <td>2</td>\n",
       "      <td>238</td>\n",
       "      <td>237</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>239</th>\n",
       "      <td>二、塔加里揚 戰役地點與開發基地的關聯評估</td>\n",
       "      <td>2</td>\n",
       "      <td>239</td>\n",
       "      <td>237</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  tit  lev   id parent_id\n",
       "180                       (一)開發行為模擬操作    3  180       179\n",
       "181                         (二)景觀影響預測    3  181       179\n",
       "182                        7.4.2 遊憩環境    1  182       173\n",
       "183                        一、開發行為影響預測    2  183       182\n",
       "184                    (一)施工期間的遊憩影響預測    3  184       183\n",
       "185                  1.施工影響遊憩據點的交通可及性    4  185       184\n",
       "186                 2.施工影響鄰近遊憩據點的遊憩體驗    4  186       184\n",
       "187                  (二)完工營運期間的遊憩影響預測    3  187       183\n",
       "188                    1.燃氣機組設置後的視覺影響    4  188       187\n",
       "189                    二、可能影響遊憩點預測與評估    2  189       182\n",
       "190                      (一)興達港 /情人碼頭    3  190       189\n",
       "191                         (二)茄萣濕地公園    3  191       189\n",
       "192                           (三)永安濕地    3  192       189\n",
       "193                         (四)大崗山風景區    3  193       189\n",
       "194                          (五)鹽田彩繪村    3  194       189\n",
       "195                        (六)漯底山自然公園    3  195       189\n",
       "196                        三、遊憩影響綜合評估    2  196       182\n",
       "197                       1.興達港 /情人碼頭    4  197       196\n",
       "198                          2.茄萣濕地公園    4  198       196\n",
       "199                            3.永安濕地    4  199       196\n",
       "200                          4.大崗山風景區    4  200       196\n",
       "201                           5.鹽田彩繪村    4  201       196\n",
       "202                         6.漯底山自然公園    4  202       196\n",
       "203                    7.4.3 概念設計國際競圖    1  203       173\n",
       "204                       7.5  社會經濟環境    0  204      None\n",
       "205                        7.5.1 土地利用    1  205       204\n",
       "206                            一、施工期間    2  206       205\n",
       "207                            二、營運期間    2  207       205\n",
       "208                        7.5.2 人口特性    1  208       204\n",
       "209                            一、施工期間    2  209       208\n",
       "210                            二、營運期間    2  210       208\n",
       "211                   7.5.3 就業機會與產業結構    1  211       204\n",
       "212                            一、施工期間    2  212       211\n",
       "213                            二、營運期間    2  213       211\n",
       "214                     7.5.4 公共設施 服務    1  214       204\n",
       "215                            一、施工期間    2  215       214\n",
       "216                            二、營運期間    2  216       214\n",
       "217                        7.5.5 交通運輸    1  217       204\n",
       "218                            一、施工期間    2  218       217\n",
       "219                           (一)施工人員    3  219       218\n",
       "220                           (二)施工車輛    3  220       218\n",
       "221                           (三)管線開挖    3  221       218\n",
       "222                           (四)衝擊評估    3  222       218\n",
       "223                  (五)降低交通影響及維護安全措施    3  223       218\n",
       "224   1.大型車輛車體大，轉彎內外輪差亦大，影響駕駛本身及其他用路人    4  224       223\n",
       "225   2.大型車輛車身載重大，重心高，影響行車穩定性及停車視距。由於    4  225       223\n",
       "226  3.車輛行駛於路面對道路破壞力與車速、載重成正比，大型車 輛有較    4  226       223\n",
       "227   4.大型車輛及其駕駛較易有疲勞駕駛的問題，因此載運車輛應定期實    4  227       223\n",
       "228                     (六)新增施工臨時替代道路    3  228       218\n",
       "229                            二、營運期間    2  229       217\n",
       "230                          (一) 營運人力    3  230       229\n",
       "231        (二) 舊廠區五部 燃氣機組等設備拆除作業 施工車輛    3  231       229\n",
       "232                          (三) 衝擊評估    3  232       229\n",
       "233                  (四)降低交通影響及維護安全措施    3  233       229\n",
       "234         7.5.6  應用熱電共生系統供應區域冷熱需求評估    1  234       204\n",
       "235                      一、供應附近工業區可行性    2  235       234\n",
       "236                       二、供應附近社區可行性    2  236       234\n",
       "237                         7.6  文化資產    0  237      None\n",
       "238                一、本案 開發對鹽場遺跡文資影響評估    2  238       237\n",
       "239             二、塔加里揚 戰役地點與開發基地的關聯評估    2  239       237"
      ]
     },
     "execution_count": 321,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.iloc[180:240]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 319,
   "id": "dea8817a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tit</th>\n",
       "      <th>lev</th>\n",
       "      <th>id</th>\n",
       "      <th>parent_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>一、地震</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>一、空氣品質模擬</td>\n",
       "      <td>2</td>\n",
       "      <td>12</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>64</th>\n",
       "      <td>一、噪音</td>\n",
       "      <td>2</td>\n",
       "      <td>64</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>一、水文</td>\n",
       "      <td>2</td>\n",
       "      <td>98</td>\n",
       "      <td>97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>110</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>110</td>\n",
       "      <td>109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>113</td>\n",
       "      <td>112</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123</th>\n",
       "      <td>一、本計畫溫排水擴散模擬</td>\n",
       "      <td>2</td>\n",
       "      <td>123</td>\n",
       "      <td>122</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>127</td>\n",
       "      <td>126</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>134</td>\n",
       "      <td>133</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>159</td>\n",
       "      <td>158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>162</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>162</td>\n",
       "      <td>161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>175</th>\n",
       "      <td>一、開發行為景觀現況美質影響調查</td>\n",
       "      <td>2</td>\n",
       "      <td>175</td>\n",
       "      <td>174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183</th>\n",
       "      <td>一、開發行為影響預測</td>\n",
       "      <td>2</td>\n",
       "      <td>183</td>\n",
       "      <td>182</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>206</td>\n",
       "      <td>205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>209</td>\n",
       "      <td>208</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>212</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>212</td>\n",
       "      <td>211</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>215</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>215</td>\n",
       "      <td>214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>218</th>\n",
       "      <td>一、施工期間</td>\n",
       "      <td>2</td>\n",
       "      <td>218</td>\n",
       "      <td>217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>235</th>\n",
       "      <td>一、供應附近工業區可行性</td>\n",
       "      <td>2</td>\n",
       "      <td>235</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>238</th>\n",
       "      <td>一、本案 開發對鹽場遺跡文資影響評估</td>\n",
       "      <td>2</td>\n",
       "      <td>238</td>\n",
       "      <td>237</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>241</th>\n",
       "      <td>一、  廠區外輸氣管線</td>\n",
       "      <td>2</td>\n",
       "      <td>241</td>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    tit  lev   id parent_id\n",
       "6                  一、地震    2    6         5\n",
       "9                一、施工期間    2    9         8\n",
       "12             一、空氣品質模擬    2   12        11\n",
       "64                 一、噪音    2   64        63\n",
       "98                 一、水文    2   98        97\n",
       "110              一、施工期間    2  110       109\n",
       "113              一、施工期間    2  113       112\n",
       "123        一、本計畫溫排水擴散模擬    2  123       122\n",
       "127              一、施工期間    2  127       126\n",
       "134              一、施工期間    2  134       133\n",
       "159              一、施工期間    2  159       158\n",
       "162              一、施工期間    2  162       161\n",
       "175    一、開發行為景觀現況美質影響調查    2  175       174\n",
       "183          一、開發行為影響預測    2  183       182\n",
       "206              一、施工期間    2  206       205\n",
       "209              一、施工期間    2  209       208\n",
       "212              一、施工期間    2  212       211\n",
       "215              一、施工期間    2  215       214\n",
       "218              一、施工期間    2  218       217\n",
       "235        一、供應附近工業區可行性    2  235      None\n",
       "238  一、本案 開發對鹽場遺跡文資影響評估    2  238       237\n",
       "241         一、  廠區外輸氣管線    2  241       240"
      ]
     },
     "execution_count": 319,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.loc[df.tit.map(lambda x:'一'==x[0])]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
